# ExcelBench Fidelity Scoring Rubrics

> Generated by GPT 5.2 Pro, February 2026

Below are **objective 0-3 fidelity rubrics** for all 23 features, with **independent Read vs Write scoring** and **edge cases** that cleanly separate score levels.

## Global Scoring Rules (apply to every feature)

* **Excel Repair Dialog / corrupted workbook / broken parts** after write (or after read-modify-write) - **Write score = 0** for that feature, even if some content appears.
* **Silent omission** (drops feature but keeps file valid) - score depends on scope:
  * Drops the **entire feature category** - usually caps at **0-1**
  * Drops **rare edge cases only** - usually **2**
* **Theme-aware vs explicit values**
  * If a library **normalizes theme to resolved RGB** on read or write, that's typically **2** (minor fidelity loss).
  * **3** requires preserving **theme references** (where applicable), not just visual equivalence.
* **Round-trip definition for "Complete (3)"**
  * **Read:** You can extract everything needed to reconstruct the original feature (including metadata like priority, scope, flags).
  * **Write:** A workbook produced by the library is **indistinguishable from Excel** for that feature when reopened in Excel, and survives **save again in Excel** with no unexpected changes.

---

## Tier 1 - Essential

---

## 1) Cell Values

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Cannot reliably load cells or types - errors, wrong sheet decode, or widespread coercion that changes values. | Cannot write values without corruption, major type loss, or Excel repair. |
| 1 | Reads a subset only (often strings and numbers) - coerces dates/booleans/errors to strings or numbers; blanks mishandled. | Writes basic strings/numbers only - dates written as strings or wrong serials; booleans/errors unsupported. |
| 2 | Correctly reads common types (string, number, boolean, date serial, error) for typical ranges; minor loss in edge cases (eg blank vs empty string). | Correctly writes common types so Excel displays expected results; minor fidelity loss in edge cases (eg pre-1900 dates, long strings, rare error codes). |
| 3 | Full type fidelity - preserves empty string vs blank, all Excel error codes, 1900/1904 date systems, large numeric precision constraints, and Unicode. | Full fidelity output for all types - correct OOXML types, date system flags, error values, shared strings behavior; round-trip preserves types exactly. |

### Key Edge Cases to Test
- **Blank vs empty string**: empty string should not become truly blank (and vice versa).
- **Unicode and emoji**: surrogate pairs, combining marks, RTL text.
- **Very long strings**: near Excel cell limit, plus shared-string table growth.
- **Scientific notation**: large/small magnitudes, avoiding stringification.
- **Dates before 1900**: behavior differs between Excel and libraries - ensure consistent policy.
- **1900 vs 1904 date system**: workbook-level flag must be honored.
- **Error values**: `#DIV/0!`, `#N/A`, `#VALUE!`, `#REF!`, `#NAME?`, `#NUM!`, `#NULL!`, `#SPILL!` (where applicable).

### Scoring Notes
- If a library reads dates as raw serial numbers but exposes enough metadata (date system) to interpret them reproducibly, that can still be **2**.
- **3** requires preserving both the **stored representation** and the **Excel-visible semantics**.

---

## 2) Formulas

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Formulas cannot be read or are replaced with values; errors or loss across most formulas. | Cannot write formulas; Excel repairs, formulas become static values, or workbook is invalid. |
| 1 | Reads formula text for basic cells only; loses shared-formula linkage, array flags, structured refs, or cached results. | Writes simple A1 formulas (eg `=SUM(A1:A3)`) but fails on many functions or references; array/dynamic/structured unsupported. |
| 2 | Reads formula string + cached value for common formulas; preserves references across sheets; may drop advanced constructs (dynamic arrays, external links, shared formulas, structured refs). | Writes common formulas correctly and Excel recalculates on open; may not write cached results or advanced formula types; limited support for shared/array/dynamic formulas. |
| 3 | Full fidelity - preserves formula text, tokenization-sensitive constructs, shared formulas, array formulas (legacy CSE), dynamic arrays, structured references, external references metadata, and cached results where present. | Full fidelity output - writes all formula types Excel supports (within file format), correct flags (array, dynamic), shared-formula structures, calc settings, and cached results without repair dialogs. |

### Key Edge Cases to Test
- **Cached value vs formula**: cells with formula and stored result (including stale).
- **Shared formulas**: one master + clones using `si` linkage.
- **Dynamic arrays**: spilled ranges and `#SPILL!`.
- **Legacy array (CSE)**: `{=SUM(A1:A3*B1:B3)}` semantics.
- **Circular references**: workbook calc settings and iterative calc flags.
- **External references**: `[Other.xlsx]Sheet1!A1` plus link records.
- **Volatile functions**: `NOW()`, `RAND()` - ensure formula preserved even if cached differs.
- **Structured references**: `Table1[Column]` and `[@Column]`.

### Scoring Notes
- **Formula evaluation by the library is not required** for **3**. Fidelity is about **preserving Excel's formula model**, not re-implementing it.
- If the library rewrites formulas (eg changes `INDEX/MATCH` formatting or adds implicit intersection changes) - cap at **2** unless rewrite is provably equivalent and stable.

---

## 3) Basic Text Formatting

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Cannot read font properties or returns defaults for most formatted cells; errors or missing style table. | Cannot write font formatting; Excel repairs styles or formatting broadly missing. |
| 1 | Reads basic flags (bold/italic/underline/strike) but loses font name/size/color; no distinction between theme and RGB. | Writes a limited subset (eg bold/italic) with default font/size; colors unreliable. |
| 2 | Reads common full-cell font properties (name, size, RGB color, basic decorations); may drop theme font/color mapping or rich text runs. | Writes common full-cell font properties correctly; theme colors may be flattened to RGB; rich text unsupported. |
| 3 | Full fidelity - preserves theme fonts, theme colors with tints, underline variants, and rich text runs (multiple formats in one cell) including run order and properties. | Full fidelity output including rich text runs, theme-aware fonts/colors, and stable round-trip even when fonts are missing on the system (no substitution side effects in file). |

### Key Edge Cases to Test
- **Rich text**: multiple runs with different bold/color in one cell.
- **Theme colors vs RGB**: Accent1 with tint vs explicit `#RRGGBB`.
- **Underline variants**: single, double, accounting underline (if supported).
- **Nonexistent fonts**: write a font not installed - file should still encode it.

### Scoring Notes
- If the library reads theme color but only provides resolved RGB, that's usually **2**.
- If rich text is collapsed into a single style, cap at **2**.

---

## 4) Cell Background Color (Fill)

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Cannot detect fills or misreads most cells as default; errors parsing fills. | Cannot write fills; Excel repairs or fill records invalid. |
| 1 | Reads only "has fill" with incorrect color detail (eg always white or default). | Writes only a limited palette or only solid fills with default color; theme ignored. |
| 2 | Reads/writes solid fills correctly for common cases; may drop pattern fills, gradients, or theme mapping. | Writes solid fills accurately for common cases; patterns/gradients/theme tints may degrade. |
| 3 | Full fidelity - preserves solid, pattern, gradient fills, theme colors and tints, and foreground/background distinctions. | Full fidelity output for all fill types and theme-aware mappings; round-trip stable. |

### Key Edge Cases to Test
- **Pattern fills**: eg gray125, lightGrid.
- **Gradient fills**: linear/path gradients.
- **Theme fill**: theme color with tint and transparency.
- **Foreground vs background**: pattern uses both.

### Scoring Notes
- If patterns or gradients are silently dropped but solids are correct, that's typically **2**.

---

## 5) Number Formats

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Formats unreadable or all cells report "General"; errors in styles. | Cannot write formats; Excel repairs, or formats become unusable. |
| 1 | Reads built-in ids only (eg "Currency") but loses custom format strings; conditional sections ignored. | Can apply a few built-ins only; custom format strings dropped or mangled. |
| 2 | Reads/writes built-ins and common custom strings accurately; may mishandle complex conditionals, locale tokens, or four-part formats. | Writes common custom format codes so Excel renders correctly; advanced edge cases may degrade. |
| 3 | Full fidelity - preserves exact format code strings, built-in id mapping, locale and conditional syntax, and four-part formats with correct escaping. | Full fidelity output - exact code preservation, stable round-trip, no normalization or rewriting that changes display semantics. |

### Key Edge Cases to Test
- **Four-part formats**: `pos;neg;zero;text`.
- **Conditional formats inside number format**: `[Red][<0]...`.
- **Locale-specific tokens**: currency symbols, locale date tokens.
- **Escapes and literal text**: `"USD "0.00`.
- **Accounting**: alignment spacing behavior.

### Scoring Notes
- If the library normalizes format strings (eg re-escapes or rewrites but preserves display), that's usually **2** unless you can prove byte-for-byte preservation for **3**.

---

## 6) Cell Alignment

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Alignment info not accessible or causes parse failures. | Writing alignment breaks styles or causes repair. |
| 1 | Reads/writes only basic horizontal alignment; ignores wrap/rotation/indent. | Can set left/center/right only; other fields dropped. |
| 2 | Reads/writes common properties: horizontal, vertical, wrap, indent, rotation; may fail on vertical text, distributed/justify nuances, or wrap+rotation interactions. | Outputs typical alignment faithfully; some advanced combinations not preserved. |
| 3 | Full fidelity - all alignment modes including justify, distributed, vertical text, shrink-to-fit, precise rotation encoding, and stable interaction behaviors. | Full fidelity output for all alignment attributes and combinations with round-trip stability. |

### Key Edge Cases to Test
- **Rotation + wrap**: ensure both persist.
- **Vertical text mode**: "vertical" vs rotated.
- **Distributed + indent**: combined settings.
- **Shrink-to-fit**: separate from wrap.

### Scoring Notes
- If rotation is snapped or clamped incorrectly, cap at **2**.

---

## 7) Borders

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Borders not readable or style table broken. | Borders cannot be written or cause Excel repair. |
| 1 | Detects border presence only; loses per-edge style/color or collapses to defaults. | Can write basic borders but limited styles/colors; per-edge differences lost. |
| 2 | Reads/writes common border positions and styles with colors; may drop diagonal borders, rare styles, or theme colors. | Outputs most borders correctly; diagonal and exotic styles may degrade. |
| 3 | Full fidelity for all edges including diagonals, all style variants, colors including theme/tint, and explicit "none" semantics. | Full fidelity output for any border Excel can represent with stable round-trip. |

### Key Edge Cases to Test
- **Diagonal borders**: up, down, both.
- **Rare styles**: hair, slantDashDot, mediumDashDotDot variants.
- **Mixed edges**: each side different style/color.
- **None vs absent**: explicit none should round-trip.

### Scoring Notes
- Theme-to-RGB flattening is typically **2**.

---

## 8) Column Widths / Row Heights

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Dimensions unreadable or sheet layout fails to load. | Writing dimensions corrupts sheet XML or triggers repair. |
| 1 | Reads only defaults; ignores explicit widths/heights and hidden flags. | Can set widths/heights crudely; unit conversion wrong; hidden unsupported. |
| 2 | Reads/writes explicit widths/heights and hidden rows/cols; best-fit flags may be ignored; minor conversion drift. | Produces mostly correct dimensions in Excel; small rounding differences acceptable. |
| 3 | Full fidelity - preserves default vs explicit, best-fit/auto flags, hidden state, and precise unit conversions consistent with Excel. | Full fidelity output matching Excel's rendering and round-trip stable. |

### Key Edge Cases to Test
- **Very narrow columns**: near minimum width.
- **Default vs explicit**: explicitly set to default should remain explicit.
- **Hidden rows/columns**: ensure flags persist.
- **Best-fit**: preserve `bestFit` and related flags.

### Scoring Notes
- Auto-fit computation is not required, but preserving the **flags** is part of **3**.

---

## 9) Multiple Sheets

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Cannot enumerate sheets reliably or loses most sheet metadata. | Writing multiple sheets breaks workbook structure or causes repair. |
| 1 | Reads sheet names only; loses order, visibility, active sheet, tab color. | Can create multiple sheets but order and metadata unreliable; hidden states lost. |
| 2 | Reads/writes names, order, active sheet, and common visibility states; may fail on very hidden, tab colors, or unusual names. | Produces stable multi-sheet workbooks; minor metadata loss in edge cases. |
| 3 | Full fidelity - preserves exact sheet order, active tab, visibility (visible/hidden/very hidden), tab color, and name constraints handling. | Full fidelity output with correct workbook relationships and stable round-trip. |

### Key Edge Cases to Test
- **Unicode and special chars in names**.
- **Max length**: 31 chars enforcement.
- **Very hidden**: not accessible via UI in Excel.
- **Tab color**: theme vs RGB.

### Scoring Notes
- If invalid names are silently mutated (eg truncated) without reporting, cap at **2**.

---

## Tier 2 - Standard

---

## 10) Merged Cells

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Merge ranges unreadable or causes parse errors. | Writing merges corrupts sheet or causes repair. |
| 1 | Detects merged regions but loses exact range or mishandles values in merged area. | Can create merges but range normalization wrong; overlapping merges not handled. |
| 2 | Reads/writes merged ranges accurately for common cases; may mishandle formatting inheritance or overlap detection. | Produces correct merges in Excel; partial edge cases may be dropped. |
| 3 | Full fidelity - exact ranges, correct top-left value semantics, formatting behavior preserved, and overlap/invalid merges handled deterministically. | Full fidelity output with correct constraints enforcement and round-trip stability. |

### Key Edge Cases to Test
- **Value not in top-left**: ensure read policy is consistent and reproducible.
- **Formatting across merge**: different formats inside merged area.
- **Overlapping merges**: detect and reject or normalize consistently.
- **Partial overlaps with existing merges**.

### Scoring Notes
- For scoring consistency: treat "non-top-left values" as data integrity - if they are silently lost, cap at **2** unless explicitly surfaced to caller.

---

## 11) Conditional Formatting (Standard)

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Conditional formatting unreadable or breaks sheet parsing. | Writing CF corrupts file or triggers repair. |
| 1 | Reads only presence/range; loses rule type, operators, or formatting payload. | Writes a single simple rule type with limited formatting; priority ignored. |
| 2 | Reads/writes common rule types and preserves priority for typical scenarios; data bars/color scales/icon sets may be partial; stop-if-true may be lost. | Produces usable CF for common cases; some advanced rule interactions may degrade. |
| 3 | Full fidelity - all listed standard rule types, rule priority, stop-if-true, multi-rule stacking, and cross-sheet references preserved. | Full fidelity output matching Excel behavior and stable round-trip. |

### Key Edge Cases to Test
- **Multiple rules same range**: priority and stop-if-true.
- **Formula-based rule**: references another cell and sheet.
- **Data bars/color scales/icon sets**: baseline support check (full details in Feature 20).
- **Duplicate/unique** and **text contains** rules.

### Scoring Notes
- If rules are read but formatting payload is collapsed (eg always fill only), cap at **2**.

---

## 12) Data Validation

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Validation records unreadable or break sheet load. | Writing validations corrupts file or triggers repair. |
| 1 | Reads only that validation exists; loses type/formula, messages, or flags. | Writes only basic list or number validation; messages and flags ignored. |
| 2 | Reads/writes common validation types and formulas; preserves allow-blank and show dropdown; may fail on cross-sheet ranges or custom formulas. | Works for typical dropdowns and numeric/date rules; some edge cases degrade. |
| 3 | Full fidelity - all validation types, input/error messages, styles, allow-blank, in-cell dropdown, range-based lists (including cross-sheet via named ranges), and exact formulas preserved. | Full fidelity output and round-trip stable. |

### Key Edge Cases to Test
- **List from explicit CSV** vs **list from range**.
- **Cross-sheet list**: often requires named range indirection.
- **Custom formula**: relative references.
- **Allow blank** and error alert styles.

### Scoring Notes
- Cross-sheet validations that Excel supports only via named ranges - if library can't encode that workaround, cap at **2**.

---

## 13) Hyperlinks

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Hyperlinks unreadable or relationships broken. | Writing hyperlinks breaks relationships or triggers repair. |
| 1 | Reads only target URL; loses display text, tooltip, or internal link targets. | Writes only basic URL; cannot write internal links or loses display text. |
| 2 | Reads/writes external and internal hyperlinks with display text; may drop tooltips, special chars, or very long URLs. | Produces usable hyperlinks in Excel; minor metadata loss possible. |
| 3 | Full fidelity - external (http/mailto/file), internal (sheet/cell), tooltips, display text, and relationship encoding preserved for all valid URLs. | Full fidelity output with correct rels, anchors, and stable round-trip. |

### Key Edge Cases to Test
- **Internal link**: to sheet and to a cell address.
- **Display text vs target**: separate fields.
- **Tooltip**: screen tip text.
- **Long URLs** and URL encoding characters.

### Scoring Notes
- If the library stores hyperlinks as plain text formatting only, that's **0-1** depending on whether Excel recognizes them as links.

---

## 14) Images / Embedded Objects

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Drawings cause parse errors or images inaccessible. | Writing images corrupts drawing parts or triggers repair. |
| 1 | Detects images exist but cannot extract bytes or loses anchors/positions. | Can insert image but position/size unreliable; only one anchor mode. |
| 2 | Reads/writes common embedded images with approximate positioning and sizing; may lose alt text, compression settings, or exact anchor offsets. | Images appear correctly in Excel for typical cases; advanced metadata may drop. |
| 3 | Full fidelity - preserves image bytes, type, embedded vs linked, anchoring model, precise offsets, z-order, and alt text. | Full fidelity output matching Excel placement behavior and round-trip stable. |

### Key Edge Cases to Test
- **Cell-anchored vs free-floating**: one-cell vs two-cell anchors.
- **Exact offsets**: pixel-level drift from EMU conversion.
- **Embedded vs linked**: relationship types.
- **Alt text** and object name.

### Scoring Notes
- If images are re-encoded (quality loss) or format-converted without preserving original bytes, cap at **2**.

---

## 15) Pivot Tables

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Pivot parts cause errors or are unreadable. | Writing pivot tables corrupts file or Excel repairs pivot parts. |
| 1 | Detects a pivot exists but cannot read field layout, cache, or target range. | Can create a placeholder pivot shell only, missing cache/fields. |
| 2 | Reads structure (row/col/value/filter fields) for common pivots; may not fully parse caches, grouping, or calculated fields. | Can create basic pivots with standard aggregations; may not support grouping, calculated fields, or styles. |
| 3 | Full fidelity - reads/writes pivot definitions, cache connections, field settings, grouping, calculated fields/items, multiple value fields, and pivot styles with round-trip stability. | Full fidelity output matching Excel behavior and reopen stability. |

### Key Edge Cases to Test
- **Multiple value fields**: sum + count simultaneously.
- **Grouping**: date grouping (months/quarters) and numeric bins.
- **Calculated fields**: formula-driven pivot values.
- **Pivot styles** and subtotals/grand totals settings.

### Scoring Notes
- Many libraries intentionally avoid writing pivots - that should score **0-1** for write rather than being averaged with read.

---

## 16) Comments and Notes

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Comments/notes parts break load or are unreadable. | Writing comments breaks file or triggers repair. |
| 1 | Reads legacy notes only or reads text only without author/position; threaded comments ignored. | Writes only plain legacy note text; loses author/shape/visibility. |
| 2 | Reads/writes legacy notes with author and text; threaded comments may be read as flattened text or dropped; formatting lost. | Produces usable notes in Excel; threaded comment fidelity limited. |
| 3 | Full fidelity - legacy notes and modern threaded comments including authors, timestamps, replies, resolved status, and rich text preserved. | Full fidelity output with correct parts/relationships and stable round-trip. |

### Key Edge Cases to Test
- **Threaded comment with replies** and resolved state.
- **Legacy note positioning/sizing** (VML shapes).
- **Formatted text** inside comment.
- **Multiple authors** in a thread.

### Scoring Notes
- If modern threaded comments are down-converted to legacy notes, cap at **2**.

---

## 17) Freeze Panes / Split Views

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | View settings unreadable or break sheet view parsing. | Writing view settings corrupts sheet view or causes repair. |
| 1 | Reads only that a freeze/split exists; loses exact row/col, active pane, or top-left cell. | Can freeze first row/col only; other configurations ignored. |
| 2 | Reads/writes common freeze configurations (rows, cols, both) and split positions; may drop pane selection state or interaction with hidden rows/cols. | Works for typical sheet navigation patterns; minor metadata loss. |
| 3 | Full fidelity - freeze and split with correct panes, selection, top-left cell, and stable behavior with hidden rows/cols. | Full fidelity output matching Excel behavior on reopen. |

### Key Edge Cases to Test
- **Freeze both row and column** with non-A1 top-left.
- **Split views** (not freeze) with exact split positions.
- **Hidden rows/cols** interacting with freeze lines.
- **Active pane and selection** state.

### Scoring Notes
- If the library can set freeze but not preserve selection pane metadata, that's typically **2**.

---

## Tier 3 - Advanced

---

## 18) Charts

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Chart parts break load or charts inaccessible. | Writing charts corrupts drawing/chart parts or triggers repair. |
| 1 | Detects chart existence and type only; cannot read series, axes, or formatting. | Can create only a minimal chart with defaults; limited types; loses data linkage. |
| 2 | Reads/writes common chart types and core elements (title, legend, axes, labels) with correct data ranges; may fail on combo charts, secondary axes, trendlines, or error bars. | Charts render correctly for typical use cases; advanced features may drop. |
| 3 | Full fidelity - all listed chart types, full element set, embedded vs chart sheet, secondary axis, trendlines, error bars, and stable round-trip formatting and references. | Full fidelity output matching Excel's chart XML structures and behavior. |

### Key Edge Cases to Test
- **Secondary axis** with mixed series.
- **Combo chart** (line + column).
- **Trendlines** and **error bars**.
- **Chart sheet vs embedded chart**.
- **Series formatting** and data labels.

### Scoring Notes
- If a library rasterizes charts (image export) instead of true chart objects, score **0-1** for chart fidelity.

---

## 19) Named Ranges

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Names unreadable or break workbook parsing. | Writing names corrupts workbook or breaks calc chain. |
| 1 | Reads workbook-scoped names only as plain strings; loses scope, refersTo formula, or hidden flag. | Can create basic names pointing to a range only; formulas/constants unsupported. |
| 2 | Reads/writes common names with correct scope (workbook vs sheet) and refersTo formulas; may fail on dynamic named ranges, special characters, or conflicts. | Produces usable names for most workbooks; edge cases may degrade. |
| 3 | Full fidelity - scope rules, hidden names, dynamic formulas, constants, special-character handling, and deterministic conflict resolution preserved. | Full fidelity output with stable round-trip and correct relationship to sheets and formulas. |

### Key Edge Cases to Test
- **Sheet-scoped vs workbook-scoped** same name.
- **Dynamic named range** using OFFSET/INDEX.
- **Name conflicts** and renaming rules.
- **Special characters** and unicode in names.

### Scoring Notes
- If names are read but rewritten or normalized on write, cap at **2** unless exact preservation is proven.

---

## 20) Complex Conditional Formatting

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Complex CF breaks parsing or is inaccessible. | Writing complex CF causes repair or invalid behavior. |
| 1 | Reads complex rules but flattens them (eg reads color scale as "exists"); thresholds and formulas lost. | Can write only simplified versions (eg 2-color scale only, default thresholds). |
| 2 | Reads/writes multi-threshold color scales, icon sets, and complex formulas for typical cases; may fail on custom midpoints, relative refs, non-contiguous ranges, or mixed rule stacks. | Produces mostly correct rendering in Excel; some edge interactions may differ. |
| 3 | Full fidelity - nested rule stacks, custom midpoints, custom icon thresholds, relative reference semantics, and non-contiguous range application preserved exactly with stable priority behavior. | Full fidelity output matching Excel behavior and round-trip stable. |

### Key Edge Cases to Test
- **3-color scale with custom midpoint type/value**.
- **Icon set with custom thresholds** (percent, number, formula).
- **Relative references** in CF formulas across a range.
- **Non-contiguous ranges** using one rule.
- **Rule interactions**: stop-if-true with multiple complex rules.

### Scoring Notes
- "Looks similar" is not enough for **3** - thresholds and rule XML must round-trip without semantic change.

---

## 21) Tables (Structured References)

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Table parts break load or tables are unreadable. | Writing tables corrupts workbook or causes repair. |
| 1 | Detects table existence and name only; loses columns, style, header/total rows, and table range. | Can create a plain range but not a real table object. |
| 2 | Reads/writes core table structure: range, headers, columns, style name, header row flag; structured refs in formulas may be read as plain text; calculated columns and resizing may be limited. | Produces usable tables in Excel with common features; advanced semantics may degrade. |
| 3 | Full fidelity - ListObject/table definitions, style, header/total rows, auto-expansion behaviors, calculated columns, table resize, and structured references in formulas preserved. | Full fidelity output matching Excel's table semantics and stable round-trip. |

### Key Edge Cases to Test
- **Calculated columns**: automatic formula fill down the column.
- **Total row** with aggregates.
- **Resize table** and ensure refs update.
- **Structured reference formulas**: `Table1[Col]`, `[@Col]`, and intersections.

### Scoring Notes
- If tables are down-converted to plain ranges, score **0-1** for table fidelity even if data remains.

---

## 22) Print Settings

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Print settings unreadable or break worksheet/workbook parsing. | Writing print settings corrupts file or triggers repair. |
| 1 | Reads only a subset (eg orientation) and drops most fields; headers/footers lost. | Writes only basic orientation/margins; print area/titles and headers/footers ignored. |
| 2 | Reads/writes common settings: orientation, margins, paper size, print area, print titles, scaling; may lose complex headers/footers fields or manual page breaks. | Output matches typical Excel print configuration; advanced features may drop. |
| 3 | Full fidelity - complete page setup, headers/footers with dynamic fields, manual page breaks, scaling modes, and per-sheet print configurations preserved. | Full fidelity output with stable round-trip and correct Excel print preview behavior. |

### Key Edge Cases to Test
- **Print titles**: repeat rows/columns.
- **Print area**: multiple areas.
- **Headers/footers**: page number/date fields and formatting.
- **Manual page breaks** vs automatic.
- **Fit to page** scaling vs percent scaling.

### Scoring Notes
- If the library writes settings but Excel silently resets them on open, cap at **2**.

---

## 23) Protection

### Scoring Rubric

| Score | Read Capability | Write Capability |
|-------|-----------------|------------------|
| 0 | Protection parts unreadable or break workbook parsing. | Writing protection corrupts workbook or triggers repair. |
| 1 | Reads only "protected yes/no" without allowed actions; passwords/flags ignored. | Can toggle protection flag only; cannot set allowed actions or lock cells properly. |
| 2 | Reads/writes common sheet/workbook protection flags and allowed actions; password hashing may be unsupported or limited; cell locked/hidden may be partial. | Produces usable protection in Excel for typical cases; some advanced permissions may drop. |
| 3 | Full fidelity - sheet protection, workbook structure/windows protection, cell locked/hidden formula, allowed actions matrix, and password hash fields encoded as Excel expects (including no-password protection). | Full fidelity output matching Excel behavior and round-trip stable. |

### Key Edge Cases to Test
- **Protection without password**: allowed actions enforced.
- **Allowed actions matrix**: select locked cells, format columns, insert rows, etc.
- **Cell-level locked + hidden formula**: formula display behavior.
- **Workbook structure protection**: sheet insert/delete restrictions.

### Scoring Notes
- You do not need to break or verify passwords for scoring - you only need to verify the file encodes protection in a way Excel honors.
